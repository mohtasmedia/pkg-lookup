#!/usr/bin/env node
const e=require("https"),[n]=process.argv.slice(2),o=([n,o])=>new Promise((s,t)=>{e.get({hostname:n,path:o,headers:{"User-Agent":""}},e=>{const n=[];e.on("data",e=>n.push(e)),e.on("end",()=>s(JSON.parse(Buffer.concat(n)))),e.on("error",e=>t(e))})}).catch(e=>console.error(e)),s=(e,n)=>{const o={reset:"[0m",underline:"[4m",red:"[31m",green:"[32m",yellow:"[33m",cyan:"[36m"};return""+(o[n]+e+o.reset)},t=e=>s(e,"yellow")+": ",a=e=>e>=1024?(e/1024).toFixed(1)+"KB":e+"B",r=e=>console.log("    "+(e||""));(async()=>{try{const i=await o(["api.npms.io","/v2/package/"+encodeURIComponent(n)]);if("NOT_FOUND"===i.code)return console.log(i.message);const{collected:{metadata:c,github:p}}=i,l=await o(["bundlephobia.com","/api/size?package="+n]),d=c.links.repository.split("/"),{total_count:g}=await o(["api.github.com",`/search/issues?q=repo:${d[3]}/${d[4]}+is:pr+state:open&per_page=1`]);r(),r(`${s(c.name,"green")} - v${c.version}`),r(c.description),r(),r(`${t("Size / Gzipped")+a(l.size)} / ${a(l.gzip)}`),r(`${t("Open issues / PRs")+p.issues.openCount} / ${g}`),r(""+(t("Last updated")+`${(e=new Date(c.date)).getDay()}/${e.getMonth()+1}/${e.getFullYear()}`)),r(),r(""+(t("NPM")+s(c.links.npm,"underline"))),r(""+(t("Homepage")+s(c.links.homepage,"underline"))),r(""+(t("Repo")+s(c.links.repository,"underline"))),r(),r(""+(t("Liscnce")+c.license)),r()}catch(e){console.error(e)}var e})();
